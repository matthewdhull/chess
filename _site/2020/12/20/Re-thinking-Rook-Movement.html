<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Re Thinking rook movement | Chess with D3</title>
<meta name="generator" content="Jekyll v3.9.0" />
<meta property="og:title" content="Re Thinking rook movement" />
<meta name="author" content="matthew" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Re-thinking Rook Movement" />
<meta property="og:description" content="Re-thinking Rook Movement" />
<meta property="og:site_name" content="Chess with D3" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-12-20T00:00:00+01:00" />
<script type="application/ld+json">
{"@type":"BlogPosting","headline":"Re Thinking rook movement","dateModified":"2020-12-20T00:00:00+01:00","datePublished":"2020-12-20T00:00:00+01:00","author":{"@type":"Person","name":"matthew"},"mainEntityOfPage":{"@type":"WebPage","@id":"/2020/12/20/Re-thinking-Rook-Movement.html"},"description":"Re-thinking Rook Movement","url":"/2020/12/20/Re-thinking-Rook-Movement.html","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link href="https://unpkg.com/@primer/css/dist/primer.css" rel="stylesheet" />
  <link rel="stylesheet" href="/assets/main.css"><link type="application/atom+xml" rel="alternate" href="/feed.xml" title="Chess with D3" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css" integrity="sha384-zB1R0rpPzHqg7Kpt0Aljp8JPLqbXI3bhnPWROx27a9N0Ll6ZP/+DiW/UqRcLbRjq" crossorigin="anonymous">
    <script type="text/javascript" async src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML"> </script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.js" integrity="sha384-y23I5Q6l+B6vatafAwxRu/0oK/79VlbSz7Q9aiSZUvyWYIYsd+qj+o24G5ZU2zJz" crossorigin="anonymous"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/auto-render.min.js" integrity="sha384-kWPLUVMOks5AQFrykwIup5lo0m3iMkkHrD0uJ4H5cjeGihAutqP0yW0J6dpFiVkI" crossorigin="anonymous"></script>
    <script>
      document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement( document.body, {
          delimiters: [
            {left: "$$", right: "$$", display: true},
            {left: "[%", right: "%]", display: true},
            {left: "$", right: "$", display: false}
          ]}
        );
      });
    </script>
  

  <script>
  function wrap_img(fn) {
    if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
        var elements = document.querySelectorAll(".post img");
        Array.prototype.forEach.call(elements, function(el, i) {
            if (el.getAttribute("title")) {
                const caption = document.createElement('figcaption');
                var node = document.createTextNode(el.getAttribute("title"));
                caption.appendChild(node);
                const wrapper = document.createElement('figure');
                wrapper.className = 'image';
                el.parentNode.insertBefore(wrapper, el);
                el.parentNode.removeChild(el);
                wrapper.appendChild(el);
                wrapper.appendChild(caption);
            }
        });
    } else { document.addEventListener('DOMContentLoaded', fn); }
  }
  window.onload = wrap_img;
  </script>

</head>
<body><header class="site-header" role="banner">

  <div class="wrapper"><a class="site-title" rel="author" href="/">Chess with D3</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/about.html">About</a><a class="page-link" href="/">Building chess with D3</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Re Thinking rook movement</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2020-12-20T00:00:00+01:00" itemprop="datePublished">Dec 20, 2020
      </time>• <span itemprop="author" itemscope itemtype="http://schema.org/Person"><span class="p-author h-card" itemprop="name">matthew</span></span></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <h4 id="re-thinking-rook-movement">Re-thinking Rook Movement</h4>

<p>This bug appeared while playing <code class="language-plaintext highlighter-rouge">Rb1</code></p>

<p><img src="/chess/images/wrong_rook.gif" alt="Wrong Rook Move" /></p>

<p>We should have white’s queen rook to <code class="language-plaintext highlighter-rouge">b1</code> but the method for calculating the positions for a rook resulted in both rooks being able to move along the 1st rank.  The method for translating implict moves described previously did not consider squares that would be illegal moves caused by intermediate pieces.  Given the board state shown below, <code class="language-plaintext highlighter-rouge">Rb1</code> does not require any rank or file disambiguation in SAN.  Instead, we must internally deal with the disambiguation by only choosing the rook that could legally move to <code class="language-plaintext highlighter-rouge">b1</code></p>

<p>Below, we see the possible squares were originally calculated. The arrows span covers all possible squares considered.  In this case, it seems that both rooks can move to <code class="language-plaintext highlighter-rouge">b1</code></p>

<p><img src="/chess/images/wrong_rook_logic.png" alt="Wrong Rook Logic" /></p>

<p>To correct this, we try to find a path from the desired position, e.g., <code class="language-plaintext highlighter-rouge">b1</code> to each rook and stop if an intermediate piece exists.  If we start at position <code class="language-plaintext highlighter-rouge">b1</code> and move horizontally on rank 1, we find an intermediate piece on <code class="language-plaintext highlighter-rouge">d1</code> and that only white’s queen rook on <code class="language-plaintext highlighter-rouge">a1</code> can move to <code class="language-plaintext highlighter-rouge">b1</code>.  See <code class="language-plaintext highlighter-rouge">rookMovesFrom(fromPosition, toPosition, aBoard) </code> <a href="https://github.com/matthewdhull/chess/blob/a302b280b01ab2427bad67767b396f3b019aa2d2/scripts/pieces.js#L198">code</a></p>

<p><img src="/chess/images/correct_rook_logic.png" alt="Correct Rook Logic" /></p>

  </div><a class="u-url" href="/2020/12/20/Re-thinking-Rook-Movement.html" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">Chess with D3</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">Chess with D3</li></ul>
      </div>

      <div class="footer-col footer-col-2">-<ul class="social-media-list">
  <li><a href="https://github.com/matthewdhull"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg> <span class="username">matthewdhull</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>Notes on building chess visualizations</p>
      </div>
    </div>

  </div>

</footer>
</body>

</html>
